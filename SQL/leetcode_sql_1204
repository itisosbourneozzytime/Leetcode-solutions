with cte as
(
    select person_id, person_name, weight, turn, sum(weight) over (order by turn) as cumulative_sum
    from  queue
),
person as
(
    select max(turn) as turn
    from   cte
    where  cumulative_sum <= 1000
)
select person_name
from   queue q
join   person p
on     q.turn = p.turn
